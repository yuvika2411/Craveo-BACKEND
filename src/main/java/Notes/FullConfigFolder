Socho tumhara backend ek ğŸ¢ building hai.
Security guard ka system = **config folder**.

Is folder ka kaam hai:

> Kaun andar aa sakta hai?
> Kaun admin floor pe ja sakta hai?
> Kaun fake ID lekar aa raha hai?

# ğŸ“ CONFIG FOLDER ME 4 FILES HAIN

1. AppConfig
2. JwtConstant
3. JwtProvider
4. JwtTokenValidator

Ab ek-ek karke samjhte hain.

# 1ï¸âƒ£ JwtConstant â€“ (Secret Locker)

public class JwtConstant {
    public static final String SECRET_KEY="....";
    public static final String JWT_HEADER = "Authorization";
}

## Ye file kyu banayi?

Taaki:

* Secret key ek hi jagah rahe
* Baar-baar string hardcode na karni pade

## SECRET_KEY kya hai?

Ye tumhara **digital signature password** hai.

Jab token banega:
â†’ Ye key se sign hoga
Jab token check hoga:
â†’ Isi key se verify hoga

Agar key match nahi karegi â†’ token invalid âŒ


## JWT_HEADER kya hai?

Ye batata hai:
> Token request ke header me kaha milega

Frontend request bhejta hai:
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

Isliye hum header ka naam constant me rakhte hain.

# 2ï¸âƒ£ JwtProvider â€“ (Token Banane Wala Machine)

@Service
public class JwtProvider

Ye class token generate karti hai.

## Is file ka kaam kya hai?

ğŸ‘‰ Login ke time token banana
ğŸ‘‰ Token se email nikalna

## ğŸ”¥ generateToken Method

public String generateToken(Authentication auth)


Ye tab chalta hai jab user login karta hai.

Isme kya hota hai?

1ï¸âƒ£ User ka email liya
2ï¸âƒ£ User ke roles liye (ADMIN / USER etc)
3ï¸âƒ£ Token banaya
4ï¸âƒ£ Expiry set ki (24 hours)
5ï¸âƒ£ Secret key se sign kiya


.setExpiration(new Date(new Date().getTime()+86400000))
86400000 = 24 hours

Matlab token 1 din valid rahega.


## populateAuthorities Method

Ye roles ko string me convert karta hai.

Example:
ADMIN,USER

Kyuki JWT me direct object store nahi karte.


## getEmailFromJwtToken

Ye method token se email nikalta hai.

Jab hume token mila:
â†’ Hum usko decode karke email nikaal sakte hain.

So summary:
JwtProvider = Token BANATA hai ğŸ­


# 3ï¸âƒ£ JwtTokenValidator â€“ (Security Guard)

public class JwtTokenValidator extends OncePerRequestFilter


Ye sabse important class hai.
## Ye kya karta hai?

Har request pe check karta hai:
> Token valid hai ya nahi?

## Flow Inside doFilterInternal

String jwt = request.getHeader("Authorization");

Header se token nikala.

Agar token present hai:
jwt = jwt.substring(7);

Bearer hata diya.

## Fir kya hota hai?

1ï¸âƒ£ Secret key se token verify
2ï¸âƒ£ Claims nikale (email + roles)
3ï¸âƒ£ Authentication object banaya
4ï¸âƒ£ Spring Security context me set kiya

SecurityContextHolder.getContext().setAuthentication(authentication);

Matlab:
> Ab Spring ko pata hai user kaun hai.

Agar token galat hai:
throw new BadCredentialsException

Request reject âŒ

So summary:

JwtTokenValidator = Token CHECK karta hai ğŸ›‚

# 4ï¸âƒ£ AppConfig â€“ (Security Rules Book)

Ye sabse badi file hai.

Iska kaam:

âœ” Spring Security ON karna
âœ” Kaun access kare define karna
âœ” JWT filter add karna
âœ” CORS allow karna
âœ” Password encoder define karna


## ğŸ” Session Policy

SessionCreationPolicy.STATELESS

Matlab:
Server session store nahi karega.
Har request me token bhejna padega.


## ğŸ” Authorization Rules

.requestMatchers("/api/admin/**").hasAnyRole("RESTAURANT_OWNER","ADMIN")

Admin routes:
Sirf owner ya admin access kar sakta hai.

.requestMatchers("/api/**").authenticated()

Baaki API:
Login required.

.anyRequest().permitAll()

Baaki sab public.

## ğŸ” JWT Filter Add

.addFilterBefore(new JwtTokenValidator(), BasicAuthenticationFilter.class)

Matlab:
Basic filter se pehle
â†’ JWT token check hoga.


## ğŸ” Password Encoder

return new BCryptPasswordEncoder();

Password plain text me save nahi hoga.
Hash me save hoga.

Security ğŸ”’

# ğŸ§  FULL FLOW AB CLEAR KARO

User Login karta hai
â¬‡
Spring authenticate karta hai
â¬‡
JwtProvider token generate karta hai
â¬‡
Token frontend ko milta hai
â¬‡
Frontend har request me token bhejta hai
â¬‡
JwtTokenValidator token check karta hai
â¬‡
Agar valid â†’ request allowed


# ğŸ¯ Ek Line Me

| File              | Kaam                          |
| ----------------- | ----------------------------- |
| JwtConstant       | Secret values store karta hai |
| JwtProvider       | Token banata hai              |
| JwtTokenValidator | Token check karta hai         |
| AppConfig         | Security rules set karta hai  |


